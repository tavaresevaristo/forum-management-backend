
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  STUDENT
  INSTRUCTOR
}

model User {
  id          String        @id @default(uuid())
  name        String
  email       String        @unique
  password    String
  role        UserRole      @default(STUDENT)
  questions   Question[]
  answers     Answer[]

  @@map("users")
}

model Question {
  id        String @id @default(uuid())
  title     String
  slug      String @unique
  content   String
  created_at DateTime @default(now())
  updated_at DateTime? @updatedAt()

  answers Answer[]

  author_id  String
  best_answer_id String? @unique

  author User @relation(fields: [author_id], references: [id])
  bestAnswer Answer? @relation("bestAnswer", fields: [best_answer_id], references: [id])

  @@map("questions")
}

model Answer {
  id        String @id @default(uuid())
  content   String
  created_at DateTime @default(now())
  updated_at DateTime? @updatedAt()
  author_id  String
  question_id String

  author      User        @relation(fields: [author_id], references: [id])
  question    Question   @relation(fields: [question_id], references: [id])
  best_answer_on    Question?     @relation("bestAnswer")

  @@map("answers")
}